query_id,natural_language_query,sql_query,query_type,business_value,complexity,tables_used,filters_applied,aggregation_type
TEST_001,"Which biotechnology companies have the most partnerships?","SELECT c.companyname, COUNT(*) as partnership_count FROM ciqcompany c JOIN ciqbusinessrel br ON c.companyid IN (br.parentcompanyid, br.childcompanyid) WHERE c.simpleindustryid = 42 GROUP BY c.companyid, c.companyname ORDER BY partnership_count DESC;",sector_analysis,Biotech investment opportunity identification and partnership strength,intermediate,ciqcompany|ciqbusinessrel,industry_filter,count
TEST_002,"Find all pharmaceutical supplier relationships","SELECT supplier.companyname AS pharma_supplier, customer.companyname AS pharma_customer FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany supplier ON br.parentcompanyid = supplier.companyid JOIN ciqcompany customer ON br.childcompanyid = customer.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND (supplier.simpleindustryid = 43 OR customer.simpleindustryid = 43);",supply_chain_analysis,Pharmaceutical supply chain mapping for investment due diligence,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,none
TEST_003,"Show me companies in the banking sector with international relationships","SELECT bank.companyname, COUNT(DISTINCT related.countryid) as international_reach, COUNT(*) as total_relationships FROM ciqcompany bank JOIN ciqbusinessrel br ON bank.companyid IN (br.parentcompanyid, br.childcompanyid) JOIN ciqcompany related ON (bank.companyid = br.parentcompanyid AND related.companyid = br.childcompanyid) OR (bank.companyid = br.childcompanyid AND related.companyid = br.parentcompanyid) WHERE bank.simpleindustryid = 45 GROUP BY bank.companyid, bank.companyname HAVING COUNT(DISTINCT related.countryid) > 1 ORDER BY international_reach DESC;",geographic_analysis,International banking exposure and global diversification assessment,advanced,ciqcompany|ciqbusinessrel,industry_filter|having_clause,count|complex_joins
TEST_004,"Identify renewable energy companies with equipment suppliers","SELECT renewable.companyname AS renewable_company, COUNT(*) as equipment_suppliers FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany renewable ON br.childcompanyid = renewable.companyid JOIN ciqcompany supplier ON br.parentcompanyid = supplier.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND renewable.simpleindustryid = 64 AND supplier.simpleindustryid IN (11, 13) GROUP BY renewable.companyid, renewable.companyname ORDER BY equipment_suppliers DESC;",esg_analysis,Clean energy supply chain analysis for ESG investment strategies,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,count
TEST_005,"Find retail companies with the most diverse supplier base","SELECT retailer.companyname, COUNT(DISTINCT supplier.simpleindustryid) as supplier_diversity, COUNT(*) as total_suppliers FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany retailer ON br.childcompanyid = retailer.companyid JOIN ciqcompany supplier ON br.parentcompanyid = supplier.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND retailer.simpleindustryid IN (31, 32, 33) GROUP BY retailer.companyid, retailer.companyname HAVING COUNT(*) >= 3 ORDER BY supplier_diversity DESC;",risk_analysis,Retail supply chain diversification for operational risk assessment,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter|having_clause,count
TEST_006,"Show office REITs and their tenant industries","SELECT reit.companyname AS office_reit, COUNT(*) as tenant_count, STRING_AGG(DISTINCT CASE tenant.simpleindustryid WHEN 45 THEN 'Financial' WHEN 52 THEN 'IT Services' WHEN 16 THEN 'Professional Services' ELSE 'Other' END, ', ') as tenant_types FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany reit ON br.parentcompanyid = reit.companyid JOIN ciqcompany tenant ON br.childcompanyid = tenant.companyid WHERE rt.parentname = 'Landlord' AND rt.childname = 'Tenant' AND reit.simpleindustryid = 71 GROUP BY reit.companyid, reit.companyname ORDER BY tenant_count DESC;",reit_analysis,Office REIT tenant diversification analysis for income investing,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,count|string_aggregation|conditional_aggregation
TEST_007,"Find aerospace companies and their defense contractors","SELECT aerospace.companyname AS aerospace_company, contractor.companyname AS defense_contractor FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany aerospace ON br.parentcompanyid = aerospace.companyid JOIN ciqcompany contractor ON br.childcompanyid = contractor.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND aerospace.simpleindustryid = 8;",defense_analysis,Aerospace and defense sector supply chain for government contract analysis,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,none
TEST_008,"Which software companies have licensing agreements?","SELECT software.companyname AS software_licensor, COUNT(*) as licensing_deals, COUNT(DISTINCT licensee.simpleindustryid) as licensee_industries FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany software ON br.parentcompanyid = software.companyid JOIN ciqcompany licensee ON br.childcompanyid = licensee.companyid WHERE rt.parentname = 'Licensor' AND rt.childname = 'Licensee' AND software.simpleindustryid = 53 GROUP BY software.companyid, software.companyname ORDER BY licensing_deals DESC;",ip_analysis,Software licensing revenue analysis and intellectual property monetization,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,count
TEST_009,"Show utilities with supplier concentration risk","SELECT utility.companyname, COUNT(*) as supplier_count, CASE WHEN COUNT(*) <= 2 THEN 'High Risk' WHEN COUNT(*) <= 5 THEN 'Medium Risk' ELSE 'Low Risk' END as concentration_risk FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany utility ON br.childcompanyid = utility.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND utility.simpleindustryid IN (60, 61, 62, 63) GROUP BY utility.companyid, utility.companyname ORDER BY supplier_count ASC;",risk_analysis,Utility sector supply chain concentration risk for dividend stability assessment,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,count|conditional_aggregation
TEST_010,"Find healthcare technology companies partnering with traditional healthcare","SELECT healthtech.companyname AS healthtech_company, traditional.companyname AS traditional_healthcare, rt.parentname as partnership_type FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany healthtech ON br.parentcompanyid = healthtech.companyid JOIN ciqcompany traditional ON br.childcompanyid = traditional.companyid WHERE healthtech.simpleindustryid = 41 AND traditional.simpleindustryid = 40 AND rt.parentname IN ('Supplier', 'Company');",innovation_analysis,Healthcare digital transformation and technology adoption investment opportunities,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,none
TEST_011,"Analyze semiconductor companies and their customer industries","SELECT semi.companyname AS semiconductor_company, COUNT(DISTINCT customer.simpleindustryid) as customer_industry_diversity, COUNT(*) as total_customers FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany semi ON br.parentcompanyid = semi.companyid JOIN ciqcompany customer ON br.childcompanyid = customer.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND semi.simpleindustryid = 57 GROUP BY semi.companyid, semi.companyname HAVING COUNT(*) >= 2 ORDER BY customer_industry_diversity DESC;",sector_analysis,Semiconductor industry diversification and end market exposure analysis,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter|having_clause,count
TEST_012,"Show cross-border M&A activity in technology sector","SELECT acquirer.companyname AS tech_acquirer, target.companyname AS target_company, acquirer.countryid AS acquirer_country, target.countryid AS target_country FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany acquirer ON br.parentcompanyid = acquirer.companyid JOIN ciqcompany target ON br.childcompanyid = target.companyid WHERE rt.parentname IN ('Acquirer', 'Company') AND rt.childname IN ('Target', 'Strategic Alliance') AND acquirer.simpleindustryid IN (52, 53, 54, 55, 56, 57) AND acquirer.countryid != target.countryid;",ma_analysis,Cross-border technology M&A analysis for international expansion strategies,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter|geographic_filter,none
TEST_013,"Find companies with strong ESG partnerships","SELECT company.companyname, COUNT(CASE WHEN partner.simpleindustryid = 64 THEN 1 END) as renewable_partnerships, COUNT(CASE WHEN partner.simpleindustryid IN (39, 40) THEN 1 END) as healthcare_partnerships, COUNT(*) as total_partnerships FROM ciqcompany company JOIN ciqbusinessrel br ON company.companyid IN (br.parentcompanyid, br.childcompanyid) JOIN ciqcompany partner ON (company.companyid = br.parentcompanyid AND partner.companyid = br.childcompanyid) OR (company.companyid = br.childcompanyid AND partner.companyid = br.parentcompanyid) JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid WHERE rt.parentname = 'Company' AND rt.childname = 'Strategic Alliance' GROUP BY company.companyid, company.companyname HAVING COUNT(CASE WHEN partner.simpleindustryid IN (64, 39, 40) THEN 1 END) >= 2 ORDER BY (renewable_partnerships + healthcare_partnerships) DESC;",esg_analysis,ESG investment screening through sustainable partnership analysis,advanced,ciqcompany|ciqbusinessrel|ciqbusinessreltype,relationship_type_filter|having_clause|complex_joins,count|conditional_aggregation
TEST_014,"Identify food companies with restaurant chain customers","SELECT food.companyname AS food_supplier, restaurant.companyname AS restaurant_customer FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany food ON br.parentcompanyid = food.companyid JOIN ciqcompany restaurant ON br.childcompanyid = restaurant.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND food.simpleindustryid = 35 AND restaurant.simpleindustryid = 27;",supply_chain_analysis,Food service supply chain analysis for consumer staples investment,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,none
TEST_015,"Show chemical companies supplying renewable energy sector","SELECT chemical.companyname AS chemical_supplier, COUNT(*) as renewable_customers FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany chemical ON br.parentcompanyid = chemical.companyid JOIN ciqcompany renewable ON br.childcompanyid = renewable.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND chemical.simpleindustryid = 3 AND renewable.simpleindustryid = 64 GROUP BY chemical.companyid, chemical.companyname ORDER BY renewable_customers DESC;",esg_analysis,Chemical industry exposure to clean energy transition for investment positioning,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,count
TEST_016,"Find insurance companies with the most corporate clients","SELECT insurance.companyname AS insurance_provider, COUNT(*) as corporate_clients FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany insurance ON br.parentcompanyid = insurance.companyid JOIN ciqcompany client ON br.childcompanyid = client.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND insurance.simpleindustryid = 49 GROUP BY insurance.companyid, insurance.companyname ORDER BY corporate_clients DESC;",financial_analysis,Insurance sector client base analysis for premium growth assessment,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,count
TEST_017,"Analyze media companies and their distribution partnerships","SELECT media.companyname AS media_company, distributor.companyname AS distribution_partner FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany media ON br.parentcompanyid = media.companyid JOIN ciqcompany distributor ON br.childcompanyid = distributor.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND media.simpleindustryid = 29 AND distributor.simpleindustryid = 30;",media_analysis,Media industry distribution network analysis for content monetization assessment,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,none
TEST_018,"Show automotive companies with international supplier networks","SELECT auto.companyname AS auto_company, COUNT(DISTINCT supplier.countryid) as supplier_countries, COUNT(*) as total_suppliers FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany auto ON br.childcompanyid = auto.companyid JOIN ciqcompany supplier ON br.parentcompanyid = supplier.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND auto.simpleindustryid = 23 GROUP BY auto.companyid, auto.companyname HAVING COUNT(DISTINCT supplier.countryid) > 1 ORDER BY supplier_countries DESC;",supply_chain_analysis,Automotive global supply chain diversification for operational risk assessment,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter|having_clause,count
TEST_019,"Find telecom companies with technology partnerships","SELECT telecom.companyname AS telecom_company, tech.companyname AS tech_partner, rt.parentname as partnership_type FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany telecom ON br.parentcompanyid = telecom.companyid JOIN ciqcompany tech ON br.childcompanyid = tech.companyid WHERE telecom.simpleindustryid IN (58, 59) AND tech.simpleindustryid IN (52, 53, 54) AND rt.parentname IN ('Company', 'Licensor');",innovation_analysis,Telecom sector digital transformation and 5G infrastructure investment analysis,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,none
TEST_020,"Identify mining companies with metals processing customers","SELECT mining.companyname AS mining_company, processor.companyname AS metals_processor FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany mining ON br.parentcompanyid = mining.companyid JOIN ciqcompany processor ON br.childcompanyid = processor.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND mining.simpleindustryid = 6 AND processor.simpleindustryid IN (11, 13, 22);",commodity_analysis,Mining sector value chain analysis for commodity investment strategies,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,none
TEST_021,"Show hotel REITs with hospitality management relationships","SELECT reit.companyname AS hotel_reit, hotel.companyname AS hotel_operator, hotel.city as hotel_location FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany reit ON br.parentcompanyid = reit.companyid JOIN ciqcompany hotel ON br.childcompanyid = hotel.companyid WHERE rt.parentname = 'Landlord' AND rt.childname = 'Tenant' AND reit.simpleindustryid = 69 AND hotel.simpleindustryid = 27;",reit_analysis,Hotel REIT operational analysis for hospitality sector investment,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,none
TEST_022,"Find construction companies with real estate developer clients","SELECT construction.companyname AS construction_company, COUNT(*) as developer_clients FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany construction ON br.parentcompanyid = construction.companyid JOIN ciqcompany developer ON br.childcompanyid = developer.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND construction.simpleindustryid = 10 AND developer.simpleindustryid = 51 GROUP BY construction.companyid, construction.companyname ORDER BY developer_clients DESC;",real_estate_analysis,Construction industry real estate development exposure for cyclical investment timing,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,count
TEST_023,"Analyze logistics companies serving e-commerce retailers","SELECT logistics.companyname AS logistics_provider, retailer.companyname AS ecommerce_retailer FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany logistics ON br.parentcompanyid = logistics.companyid JOIN ciqcompany retailer ON br.childcompanyid = retailer.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND logistics.simpleindustryid = 17 AND retailer.simpleindustryid IN (31, 32);",supply_chain_analysis,E-commerce logistics infrastructure analysis for digital economy investment,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,none
TEST_024,"Show beverage companies with retail distribution networks","SELECT beverage.companyname AS beverage_company, COUNT(*) as retail_partners, COUNT(DISTINCT retailer.simpleindustryid) as retail_channel_diversity FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany beverage ON br.parentcompanyid = beverage.companyid JOIN ciqcompany retailer ON br.childcompanyid = retailer.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND beverage.simpleindustryid = 34 AND retailer.simpleindustryid IN (31, 32, 33) GROUP BY beverage.companyid, beverage.companyname ORDER BY retail_partners DESC;",consumer_analysis,Beverage industry distribution reach analysis for market penetration assessment,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,count
TEST_025,"Find young technology companies with established corporate partners","SELECT startup.companyname AS tech_startup, established.companyname AS corporate_partner, startup.yearfounded, rt.parentname as partnership_type FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany startup ON br.parentcompanyid = startup.companyid JOIN ciqcompany established ON br.childcompanyid = established.companyid WHERE startup.simpleindustryid IN (52, 53, 67) AND startup.yearfounded >= 2015 AND established.yearfounded <= 2000 AND rt.parentname IN ('Supplier', 'Company', 'Licensor');",growth_analysis,Technology startup validation through established corporate partnerships,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter|date_filter,none
TEST_026,"Identify energy companies transitioning to renewable sources","WITH energy_relationships AS (SELECT c.companyid, c.companyname, c.simpleindustryid, COUNT(CASE WHEN related.simpleindustryid = 64 THEN 1 END) as renewable_partnerships, COUNT(CASE WHEN related.simpleindustryid IN (1, 2) THEN 1 END) as traditional_partnerships FROM ciqcompany c JOIN ciqbusinessrel br ON c.companyid IN (br.parentcompanyid, br.childcompanyid) JOIN ciqcompany related ON (c.companyid = br.parentcompanyid AND related.companyid = br.childcompanyid) OR (c.companyid = br.childcompanyid AND related.companyid = br.parentcompanyid) WHERE c.simpleindustryid IN (1, 2, 60, 61, 62) GROUP BY c.companyid, c.companyname, c.simpleindustryid) SELECT companyname, CASE simpleindustryid WHEN 1 THEN 'Energy Equipment' WHEN 2 THEN 'Oil and Gas' ELSE 'Utilities' END as company_type, renewable_partnerships, traditional_partnerships FROM energy_relationships WHERE renewable_partnerships > 0 ORDER BY renewable_partnerships DESC;",energy_transition,Energy sector transition analysis for ESG and sustainability investment strategies,advanced,ciqcompany|ciqbusinessrel,industry_filter|cte|complex_joins,count|conditional_aggregation
TEST_027,"Show professional services firms with financial sector clients","SELECT services.companyname AS services_firm, COUNT(*) as financial_clients, COUNT(DISTINCT financial.simpleindustryid) as financial_sector_diversity FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany services ON br.parentcompanyid = services.companyid JOIN ciqcompany financial ON br.childcompanyid = financial.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND services.simpleindustryid = 16 AND financial.simpleindustryid IN (45, 46, 47, 48, 49) GROUP BY services.companyid, services.companyname ORDER BY financial_clients DESC;",financial_analysis,Professional services exposure to financial sector for regulatory and compliance revenue,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,count
TEST_028,"Find tobacco companies with international distribution","SELECT tobacco.companyname AS tobacco_company, COUNT(DISTINCT distributor.countryid) as distribution_countries FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany tobacco ON br.parentcompanyid = tobacco.companyid JOIN ciqcompany distributor ON br.childcompanyid = distributor.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND tobacco.simpleindustryid = 36 GROUP BY tobacco.companyid, tobacco.companyname ORDER BY distribution_countries DESC;",consumer_analysis,Tobacco industry international distribution for emerging market exposure assessment,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,count
TEST_029,"Analyze data quality by relationship source for investment decisions","SELECT rst.businessrelsourcetypename as data_source, COUNT(*) as relationship_count, ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM ciqbusinessrel), 2) as percentage_of_total FROM ciqbusinessrel br JOIN ciqbusinessrelsourcetype rst ON br.businessrelsourcetypeid = rst.businessrelsourcetypeid GROUP BY rst.businessrelsourcetypeid, rst.businessrelsourcetypename ORDER BY relationship_count DESC;",data_quality,Investment research data reliability assessment for due diligence confidence,intermediate,ciqbusinessrel|ciqbusinessrelsourcetype,none,count|mathematical_operations|subquery
TEST_030,"Show companies with highest relationship-to-age ratios","SELECT c.companyname, c.simpleindustryid, (2024 - c.yearfounded) as company_age, COUNT(*) as total_relationships, ROUND(COUNT(*) * 1.0 / (2024 - c.yearfounded), 2) as relationships_per_year FROM ciqcompany c JOIN ciqbusinessrel br ON c.companyid IN (br.parentcompanyid, br.childcompanyid) WHERE c.yearfounded IS NOT NULL AND c.yearfounded > 1950 GROUP BY c.companyid, c.companyname, c.simpleindustryid, c.yearfounded HAVING COUNT(*) >= 5 ORDER BY relationships_per_year DESC;",growth_analysis,Business development velocity analysis for growth investing and partnership expansion,advanced,ciqcompany|ciqbusinessrel,date_filter|having_clause,count|mathematical_operations
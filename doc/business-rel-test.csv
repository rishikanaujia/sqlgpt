query_id,natural_language_query,sql_query,query_type,business_value,complexity,tables_used,filters_applied,aggregation_type,test_category
T001,"Display supplier relationships for company 54321","SELECT * FROM ciqbusinessrel WHERE parentcompanyid = 54321 AND businessreltypeid IN (1,2,3,4);","select","Supply chain visibility for specific company analysis","simple","ciqbusinessrel","parentcompanyid,businessreltypeid_in","none","filter_variation"
T002,"Which companies have vendor relationships?","SELECT DISTINCT parentcompanyid FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.parentname = 'Vendor';","select_distinct","Identifies companies using vendor services for market analysis","medium","ciqbusinessrel,ciqbusinessreltype","parentname","none","distinct_query"
T003,"Count how many strategic alliances exist","SELECT COUNT(*) as alliance_count FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.childname = 'Strategic Alliance';","count","Measures partnership activity in the market","medium","ciqbusinessrel,ciqbusinessreltype","childname","count","count_variation"
T004,"Show me creditor relationships from regulatory filings","SELECT br.*, brt.parentname, brt.childname, brst.businessrelsourcetypename FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid JOIN ciqbusinessrelsourcetype brst ON br.businessrelsourcetypeid = brst.businessrelsourcetypeid WHERE brt.parentname = 'Creditor' AND brst.businessrelsourcetypename = 'Source Filing';","select_join_multi","Validates debt relationships from official sources","complex","ciqbusinessrel,ciqbusinessreltype,ciqbusinessrelsourcetype","parentname,businessrelsourcetypename","none","multi_filter"
T005,"List top 5 companies by number of subsidiaries","SELECT parentcompanyid, COUNT(DISTINCT childcompanyid) as subsidiary_count FROM ciqbusinessrel GROUP BY parentcompanyid ORDER BY subsidiary_count DESC LIMIT 5;","aggregate","Identifies major conglomerates for market concentration analysis","medium","ciqbusinessrel","none","count_distinct_group_limit","top_n_variation"
T006,"What's the breakdown of relationship sources?","SELECT businessrelsourcetypeid, COUNT(*) as count, ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM ciqbusinessrel), 2) as percentage FROM ciqbusinessrel GROUP BY businessrelsourcetypeid ORDER BY count DESC;","aggregate","Analyzes data collection methods for quality assessment","complex","ciqbusinessrel","none","percentage_calculation","percentage_query"
T007,"Find landlords with multiple tenants","SELECT br.parentcompanyid as landlord, COUNT(DISTINCT br.childcompanyid) as tenant_count FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.parentname = 'Landlord' GROUP BY br.parentcompanyid HAVING COUNT(DISTINCT br.childcompanyid) > 3;","aggregate","Identifies major real estate holders for property market analysis","medium","ciqbusinessrel,ciqbusinessreltype","parentname,having","count_distinct_group","having_clause"
T008,"Show relationships between companies 12345 and 67890","SELECT * FROM ciqbusinessrel WHERE (parentcompanyid = 12345 AND childcompanyid = 67890) OR (parentcompanyid = 67890 AND childcompanyid = 12345);","select","Examines specific bilateral business relationships","simple","ciqbusinessrel","bidirectional_companies","none","bidirectional_query"
T009,"Get franchisors and their number of franchisees","SELECT br.parentcompanyid as franchisor_id, COUNT(br.childcompanyid) as franchisee_count, GROUP_CONCAT(DISTINCT br.childcompanyid) as franchisee_ids FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.parentname = 'Franchisor' GROUP BY br.parentcompanyid;","aggregate","Maps franchise networks for expansion opportunity analysis","medium","ciqbusinessrel,ciqbusinessreltype","parentname","group_concat","group_concat_query"
T010,"Which relationship types are most common?","SELECT brt.businessreltypeid, brt.parentname, brt.childname, COUNT(br.businessrelid) as usage_count FROM ciqbusinessreltype brt LEFT JOIN ciqbusinessrel br ON brt.businessreltypeid = br.businessreltypeid WHERE brt.currentflag = 1 GROUP BY brt.businessreltypeid, brt.parentname, brt.childname ORDER BY usage_count DESC;","aggregate","Analyzes business relationship patterns in the economy","medium","ciqbusinessreltype,ciqbusinessrel","currentflag","count_group","left_join_aggregate"
T011,"Find circular relationships where A owns B and B owns A","SELECT br1.parentcompanyid as company_a, br1.childcompanyid as company_b FROM ciqbusinessrel br1 JOIN ciqbusinessrel br2 ON br1.parentcompanyid = br2.childcompanyid AND br1.childcompanyid = br2.parentcompanyid WHERE br1.parentcompanyid < br1.childcompanyid;","self_join","Detects cross-ownership for regulatory compliance","complex","ciqbusinessrel","circular_relationship","none","circular_detection"
T012,"Show investor relations firms and their clients","SELECT br.parentcompanyid as ir_firm, br.childcompanyid as client, brt.childname as service_type, brst.businessrelsourcetypename as source FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid JOIN ciqbusinessrelsourcetype brst ON br.businessrelsourcetypeid = brst.businessrelsourcetypeid WHERE brt.parentname = 'Investor Relations Firm';","select_join_multi","Maps IR service providers for capital markets analysis","complex","ciqbusinessrel,ciqbusinessreltype,ciqbusinessrelsourcetype","parentname","none","service_provider_query"
T013,"Count relationships by source for company 99999","SELECT brst.businessrelsourcetypename, COUNT(*) as relationship_count FROM ciqbusinessrel br JOIN ciqbusinessrelsourcetype brst ON br.businessrelsourcetypeid = brst.businessrelsourcetypeid WHERE br.parentcompanyid = 99999 OR br.childcompanyid = 99999 GROUP BY brst.businessrelsourcetypename;","aggregate","Evaluates data source reliability for specific company","medium","ciqbusinessrel,ciqbusinessrelsourcetype","company_or","count_group","company_specific_aggregate"
T014,"Find lessors with inactive relationships","SELECT DISTINCT br.parentcompanyid as lessor FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.parentname = 'Lessor' AND brt.currentflag = 0;","select_join","Identifies lessors with deprecated lease arrangements","medium","ciqbusinessrel,ciqbusinessreltype","parentname,currentflag","none","inactive_filter"
T015,"Show transfer agents handling more than 5 clients","SELECT br.parentcompanyid as transfer_agent, COUNT(DISTINCT br.childcompanyid) as client_count, GROUP_CONCAT(DISTINCT brt.childname) as service_types FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.parentname = 'Transfer Agent' GROUP BY br.parentcompanyid HAVING COUNT(DISTINCT br.childcompanyid) > 5;","aggregate","Identifies major transfer agents for shareholder services analysis","complex","ciqbusinessrel,ciqbusinessreltype","parentname,having","group_concat_having","complex_having"
T016,"List all licensors without source identifiers","SELECT br.* FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.parentname = 'Licensor' AND (br.sourceidentifier IS NULL OR br.sourceidentifier = '');","select_join","Identifies IP relationships needing verification","medium","ciqbusinessrel,ciqbusinessreltype","parentname,null_check","none","null_check_join"
T017,"What percentage of relationships are vendor-client?","SELECT ROUND(COUNT(CASE WHEN brt.parentname = 'Vendor' THEN 1 END) * 100.0 / COUNT(*), 2) as vendor_percentage FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid;","aggregate","Measures vendor relationship prevalence in the dataset","medium","ciqbusinessrel,ciqbusinessreltype","none","case_percentage","case_when_percentage"
T018,"Find companies named by competitors","SELECT DISTINCT br.parentcompanyid, br.childcompanyid FROM ciqbusinessrel br WHERE br.businessrelsourcetypeid = 6;","select","Reveals competitive intelligence gathering targets","simple","ciqbusinessrel","businessrelsourcetypeid","none","simple_source_filter"
T019,"Show borrowers with multiple creditors","SELECT br.childcompanyid as borrower, COUNT(DISTINCT br.parentcompanyid) as creditor_count FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.childname = 'Borrower' GROUP BY br.childcompanyid HAVING COUNT(DISTINCT br.parentcompanyid) > 2 ORDER BY creditor_count DESC;","aggregate","Identifies highly leveraged companies for credit risk analysis","complex","ciqbusinessrel,ciqbusinessreltype","childname,having","count_distinct_having","reverse_relationship"
T020,"List relationship pairs with their types","SELECT br.parentcompanyid, br.childcompanyid, CONCAT(brt.parentname, ' -> ', brt.childname) as relationship_description FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE br.businessrelid BETWEEN 27150850 AND 27150860;","select_join","Provides readable relationship mapping for reporting","medium","ciqbusinessrel,ciqbusinessreltype","businessrelid_range","none","concat_description"
T021,"Find suppliers discovered through key dev or direct contact","SELECT br.* FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.parentname = 'Supplier' AND br.businessrelsourcetypeid IN (2, 3);","select_join","Identifies directly verified supplier relationships","medium","ciqbusinessrel,ciqbusinessreltype","parentname,businessrelsourcetypeid_in","none","multiple_source_filter"
T022,"Show relationship type distribution","SELECT brt.parentname, COUNT(DISTINCT br.parentcompanyid) as parent_count, COUNT(DISTINCT br.childcompanyid) as child_count, COUNT(*) as total_relationships FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid GROUP BY brt.parentname ORDER BY total_relationships DESC;","aggregate","Analyzes market structure by relationship categories","medium","ciqbusinessrel,ciqbusinessreltype","none","multi_count_group","distribution_analysis"
T023,"Find companies with both supplier and customer roles","SELECT companyid FROM (SELECT childcompanyid as companyid FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.childname = 'Customer' INTERSECT SELECT parentcompanyid as companyid FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.parentname = 'Supplier') dual_role;","set_operation","Identifies companies in middle of supply chain","advanced","ciqbusinessrel,ciqbusinessreltype","role_intersection","none","intersect_query"
T024,"List all unique parent-child company pairs","SELECT DISTINCT parentcompanyid, childcompanyid FROM ciqbusinessrel ORDER BY parentcompanyid, childcompanyid;","select_distinct","Provides deduplicated relationship pairs for network analysis","simple","ciqbusinessrel","none","none","distinct_pairs"
T025,"Show franchisees of company 888888","SELECT br.childcompanyid as franchisee_id, br.sourceidentifier FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE br.parentcompanyid = 888888 AND brt.parentname = 'Franchisor' AND brt.currentflag = 1;","select_join","Maps franchise network for specific franchisor","medium","ciqbusinessrel,ciqbusinessreltype","parentcompanyid,parentname,currentflag","none","specific_parent_filter"
T026,"Count relationships where source identifier exists","SELECT COUNT(*) as relationships_with_source, (SELECT COUNT(*) FROM ciqbusinessrel) as total_relationships, ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM ciqbusinessrel), 2) as percentage_with_source FROM ciqbusinessrel WHERE sourceidentifier IS NOT NULL AND sourceidentifier != '';","aggregate","Measures data completeness for quality metrics","complex","ciqbusinessrel","not_null_check","count_percentage","data_quality_metric"
T027,"Find tenant companies with multiple landlords","SELECT br.childcompanyid as tenant, COUNT(DISTINCT br.parentcompanyid) as landlord_count FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.childname = 'Tenant' GROUP BY br.childcompanyid HAVING COUNT(DISTINCT br.parentcompanyid) > 1;","aggregate","Identifies companies with distributed real estate footprint","medium","ciqbusinessrel,ciqbusinessreltype","childname,having","count_distinct_having","multi_parent_analysis"
T028,"Show all relationships discovered in the last entries","SELECT br.*, brt.parentname, brt.childname, brst.businessrelsourcetypename FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid JOIN ciqbusinessrelsourcetype brst ON br.businessrelsourcetypeid = brst.businessrelsourcetypeid ORDER BY br.businessrelid DESC LIMIT 20;","select_join_multi","Reviews most recent relationship additions for data quality","complex","ciqbusinessrel,ciqbusinessreltype,ciqbusinessrelsourcetype","none","none","recent_entries"
T029,"Find licensee companies","SELECT DISTINCT br.childcompanyid as licensee_company FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.childname = 'Licensee';","select_distinct","Identifies companies using licensed technology or IP","medium","ciqbusinessrel,ciqbusinessreltype","childname","none","child_role_filter"
T030,"Compare supplier vs vendor relationship counts","SELECT 'Supplier' as relationship_type, COUNT(*) as count FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.parentname = 'Supplier' UNION ALL SELECT 'Vendor' as relationship_type, COUNT(*) as count FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.parentname = 'Vendor';","union","Compares procurement relationship types for strategy","medium","ciqbusinessrel,ciqbusinessreltype","parentname","union_count","union_comparison"
T031,"Show companies with exactly one relationship","SELECT companyid, relationship_count FROM (SELECT parentcompanyid as companyid, COUNT(*) as relationship_count FROM ciqbusinessrel GROUP BY parentcompanyid UNION ALL SELECT childcompanyid as companyid, COUNT(*) as relationship_count FROM ciqbusinessrel GROUP BY childcompanyid) all_relationships GROUP BY companyid, relationship_count HAVING SUM(relationship_count) = 1;","union_aggregate","Identifies peripheral companies in the network","advanced","ciqbusinessrel","having_sum","union_having","single_relationship"
T032,"List creditor relationships with borrower count","SELECT br.parentcompanyid as creditor, COUNT(DISTINCT br.childcompanyid) as borrower_count, MAX(br.sourceidentifier) as sample_source FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.parentname = 'Creditor' GROUP BY br.parentcompanyid ORDER BY borrower_count DESC;","aggregate","Analyzes lending concentration for financial institutions","medium","ciqbusinessrel,ciqbusinessreltype","parentname","count_max_group","aggregate_with_max"
T033,"Find companies in both lessor and lessee roles","SELECT company_id FROM (SELECT DISTINCT parentcompanyid as company_id FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.parentname = 'Lessor') lessors INNER JOIN (SELECT DISTINCT childcompanyid as company_id FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.childname = 'Lessee') lessees USING(company_id);","subquery_join","Identifies companies with complex leasing arrangements","advanced","ciqbusinessrel,ciqbusinessreltype","dual_role","none","complex_role_analysis"
T034,"Show strategic alliances with both company IDs under 1000000","SELECT br.* FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.childname = 'Strategic Alliance' AND br.parentcompanyid < 1000000 AND br.childcompanyid < 1000000;","select_join","Filters partnerships by company size proxy","medium","ciqbusinessrel,ciqbusinessreltype","childname,range_filter","none","double_range_filter"
T035,"Count unique company relationships regardless of role","SELECT COUNT(DISTINCT company_pair) as unique_relationships FROM (SELECT CASE WHEN parentcompanyid < childcompanyid THEN CONCAT(parentcompanyid, '-', childcompanyid) ELSE CONCAT(childcompanyid, '-', parentcompanyid) END as company_pair FROM ciqbusinessrel) normalized_pairs;","aggregate","Measures true unique bilateral relationships","complex","ciqbusinessrel","none","normalized_count","normalized_pairs"
T036,"Find transfer agents without active relationships","SELECT DISTINCT ta.parentcompanyid as inactive_transfer_agent FROM ciqbusinessrel ta JOIN ciqbusinessreltype ta_type ON ta.businessreltypeid = ta_type.businessreltypeid WHERE ta_type.parentname = 'Transfer Agent' AND NOT EXISTS (SELECT 1 FROM ciqbusinessrel ta2 JOIN ciqbusinessreltype ta_type2 ON ta2.businessreltypeid = ta_type2.businessreltypeid WHERE ta2.parentcompanyid = ta.parentcompanyid AND ta_type2.currentflag = 1);","exists_subquery","Identifies transfer agents needing review","advanced","ciqbusinessrel,ciqbusinessreltype","not_exists","none","not_exists_pattern"
T037,"Show vendor relationships grouped by service type","SELECT brt.childname as service_type, COUNT(*) as relationship_count, COUNT(DISTINCT br.parentcompanyid) as unique_clients FROM ciqbusinessrel br JOIN ciqbusinessreltype brt ON br.businessreltypeid = brt.businessreltypeid WHERE brt.parentname = 'Vendor' GROUP BY brt.childname;","aggregate","Analyzes vendor service distribution for market insights","medium","ciqbusinessrel,ciqbusinessreltype","parentname","multi_aggregate_group","service_grouping"
T038,"List companies with relationships from all source types","SELECT parentcompanyid FROM ciqbusinessrel GROUP BY parentcompanyid HAVING COUNT(DISTINCT businessrelsourcetypeid) = (SELECT COUNT(*) FROM ciqbusinessrelsourcetype);","aggregate_subquery","Identifies well-documented companies with diverse sources","complex","ciqbusinessrel,ciqbusinessrelsourcetype","having_all","count_distinct_having","complete_source_coverage"
T039,"Show landlord-tenant relationships with matching source identifiers","SELECT l1.parentcompanyid as landlord1, l1.childcompanyid as tenant1, l2.parentcompanyid as landlord2, l2.childcompanyid as tenant2, l1.sourceidentifier FROM ciqbusinessrel l1 JOIN ciqbusinessrel l2 ON l1.sourceidentifier = l2.sourceidentifier AND l1.businessrelid < l2.businessrelid JOIN ciqbusinessreltype lt1 ON l1.businessreltypeid = lt1.businessreltypeid JOIN ciqbusinessreltype lt2 ON l2.businessreltypeid = lt2.businessreltypeid WHERE lt1.parentname = 'Landlord' AND lt2.parentname = 'Landlord' AND l1.sourceidentifier IS NOT NULL;","self_join_complex","Links related real estate transactions from same source","advanced","ciqbusinessrel,ciqbusinessreltype","matching_source","none","source_correlation"
T040,"Calculate average relationships per company","SELECT AVG(relationship_count) as avg_relationships_per_company, MIN(relationship_count) as min_relationships, MAX(relationship_count) as max_relationships, STDDEV(relationship_count) as stddev_relationships FROM (SELECT parentcompanyid as company, COUNT(*) as relationship_count FROM ciqbusinessrel GROUP BY parentcompanyid UNION ALL SELECT childcompanyid as company, COUNT(*) as relationship_count FROM ciqbusinessrel GROUP BY childcompanyid) all_company_relationships;","statistical_aggregate","Provides network density statistics for market structure analysis","advanced","ciqbusinessrel","none","statistical_functions","statistical_analysis"
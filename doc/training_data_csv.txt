query_id,natural_language_query,sql_query,query_type,business_value,complexity,tables_used,filters_applied,aggregation_type
TRAIN_001,"Show me all technology companies","SELECT companyid, companyname, city, countryid, simpleindustryid FROM ciqcompany WHERE simpleindustryid IN (52, 53, 54, 55, 56, 57, 67) ORDER BY simpleindustryid, companyname;",sector_discovery,Company identification for tech sector investment,beginner,ciqcompany,industry_filter,none
TRAIN_002,"Find relationships between software companies","SELECT parent.companyname AS company1, child.companyname AS company2, rt.parentname, rt.childname, rst.businessrelsourcetypename FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany parent ON br.parentcompanyid = parent.companyid JOIN ciqcompany child ON br.childcompanyid = child.companyid JOIN ciqbusinessrelsourcetype rst ON br.businessrelsourcetypeid = rst.businessrelsourcetypeid WHERE parent.simpleindustryid = 53 AND child.simpleindustryid = 53;",relationship_analysis,Understanding strategic partnerships in software industry,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany|ciqbusinessrelsourcetype,industry_filter,none
TRAIN_003,"Analyze healthcare sector supply chain","SELECT supplier.companyname AS healthcare_supplier, customer.companyname AS healthcare_customer, CASE supplier.simpleindustryid WHEN 39 THEN 'Health Care Equipment' WHEN 40 THEN 'Health Care Providers' WHEN 41 THEN 'Health Care Technology' WHEN 42 THEN 'Biotechnology' WHEN 43 THEN 'Pharmaceuticals' WHEN 44 THEN 'Life Sciences Tools' END as supplier_type FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany supplier ON br.parentcompanyid = supplier.companyid JOIN ciqcompany customer ON br.childcompanyid = customer.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND supplier.simpleindustryid IN (39, 40, 41, 42, 43, 44) AND customer.simpleindustryid IN (39, 40, 41, 42, 43, 44);",supply_chain_analysis,Healthcare investment due diligence and risk assessment,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,conditional_aggregation
TRAIN_004,"Find all financial services companies and their relationships","SELECT c.companyname, CASE c.simpleindustryid WHEN 45 THEN 'Banks' WHEN 46 THEN 'Financial Services' WHEN 47 THEN 'Consumer Finance' WHEN 48 THEN 'Capital Markets' WHEN 49 THEN 'Insurance' END as financial_sector, COUNT(*) as business_relationships FROM ciqcompany c JOIN ciqbusinessrel br ON c.companyid IN (br.parentcompanyid, br.childcompanyid) WHERE c.simpleindustryid IN (45, 46, 47, 48, 49) GROUP BY c.companyid, c.companyname, c.simpleindustryid ORDER BY business_relationships DESC;",sector_analysis,Financial sector concentration analysis for portfolio diversification,intermediate,ciqcompany|ciqbusinessrel,industry_filter,count
TRAIN_005,"Compare traditional energy vs renewable energy companies","SELECT CASE WHEN c.simpleindustryid IN (1, 2) THEN 'Traditional Energy' WHEN c.simpleindustryid = 64 THEN 'Renewable Energy' WHEN c.simpleindustryid IN (60, 61, 62, 63) THEN 'Utilities' END as energy_category, COUNT(DISTINCT c.companyid) as company_count, COUNT(br.businessrelid) as total_relationships FROM ciqcompany c LEFT JOIN ciqbusinessrel br ON c.companyid IN (br.parentcompanyid, br.childcompanyid) WHERE c.simpleindustryid IN (1, 2, 60, 61, 62, 63, 64) GROUP BY energy_category ORDER BY total_relationships DESC;",sector_comparison,Energy transition investment strategy and ESG analysis,intermediate,ciqcompany|ciqbusinessrel,industry_filter,count|conditional_aggregation
TRAIN_006,"Find suppliers to renewable energy companies","SELECT supplier.companyname, CASE supplier.simpleindustryid WHEN 11 THEN 'Electrical Equipment' WHEN 13 THEN 'Machinery' WHEN 6 THEN 'Metals and Mining' WHEN 3 THEN 'Chemicals' ELSE 'Other Supplier' END as supplier_category, COUNT(*) as renewable_clients FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany supplier ON br.parentcompanyid = supplier.companyid JOIN ciqcompany renewable ON br.childcompanyid = renewable.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND renewable.simpleindustryid = 64 GROUP BY supplier.companyid, supplier.companyname, supplier.simpleindustryid ORDER BY renewable_clients DESC;",supply_chain_analysis,Clean energy investment ecosystem mapping,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,count|conditional_aggregation
TRAIN_007,"Analyze all REIT types and their tenant relationships","SELECT reit.companyname AS reit_name, CASE reit.simpleindustryid WHEN 50 THEN 'Diversified REITs' WHEN 65 THEN 'Mortgage REITs' WHEN 68 THEN 'Health Care REITs' WHEN 69 THEN 'Hotel and Resort REITs' WHEN 70 THEN 'Industrial REITs' WHEN 71 THEN 'Office REITs' WHEN 72 THEN 'Residential REITs' WHEN 73 THEN 'Retail REITs' WHEN 74 THEN 'Specialized REITs' END as reit_type, COUNT(*) as tenant_count FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany reit ON br.parentcompanyid = reit.companyid JOIN ciqcompany tenant ON br.childcompanyid = tenant.companyid WHERE rt.parentname = 'Landlord' AND rt.childname = 'Tenant' AND reit.simpleindustryid IN (50, 65, 68, 69, 70, 71, 72, 73, 74) GROUP BY reit.companyid, reit.companyname, reit.simpleindustryid ORDER BY tenant_count DESC;",real_estate_analysis,REIT income stability and diversification analysis,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,count|conditional_aggregation
TRAIN_008,"Focus on healthcare REITs and their medical tenants","SELECT reit.companyname AS healthcare_reit, tenant.companyname AS medical_tenant, CASE tenant.simpleindustryid WHEN 39 THEN 'Health Care Equipment and Supplies' WHEN 40 THEN 'Health Care Providers and Services' WHEN 41 THEN 'Health Care Technology' WHEN 42 THEN 'Biotechnology' WHEN 43 THEN 'Pharmaceuticals' WHEN 44 THEN 'Life Sciences Tools and Services' ELSE 'Non-Medical Tenant' END as tenant_type, tenant.city as tenant_location FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany reit ON br.parentcompanyid = reit.companyid JOIN ciqcompany tenant ON br.childcompanyid = tenant.companyid WHERE rt.parentname = 'Landlord' AND rt.childname = 'Tenant' AND reit.simpleindustryid = 68 ORDER BY reit.companyname, tenant_type;",reit_analysis,Healthcare REIT tenant quality assessment for income investing,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,conditional_aggregation
TRAIN_009,"Compare consumer discretionary and staples companies","SELECT CASE WHEN c.simpleindustryid IN (22, 23, 24, 25, 26, 27, 28, 29, 31, 32) THEN 'Consumer Discretionary' WHEN c.simpleindustryid IN (33, 34, 35, 36, 37, 38) THEN 'Consumer Staples' ELSE 'Other' END as consumer_category, COUNT(DISTINCT c.companyid) as company_count, COUNT(br.businessrelid) as total_relationships, COUNT(DISTINCT br.businessreltypeid) as relationship_variety FROM ciqcompany c LEFT JOIN ciqbusinessrel br ON c.companyid IN (br.parentcompanyid, br.childcompanyid) WHERE c.simpleindustryid IN (22, 23, 24, 25, 26, 27, 28, 29, 31, 32, 33, 34, 35, 36, 37, 38) GROUP BY consumer_category;",sector_comparison,Consumer sector defensive vs cyclical investment analysis,intermediate,ciqcompany|ciqbusinessrel,industry_filter,count|conditional_aggregation
TRAIN_010,"Analyze retail supply chain relationships","SELECT supplier.companyname AS supplier, retailer.companyname AS retailer, CASE supplier.simpleindustryid WHEN 35 THEN 'Food Products' WHEN 34 THEN 'Beverages' WHEN 26 THEN 'Textiles and Apparel' WHEN 37 THEN 'Household Products' WHEN 38 THEN 'Personal Care' ELSE 'Other Supplier' END as supplier_category, CASE retailer.simpleindustryid WHEN 31 THEN 'Broadline Retail' WHEN 32 THEN 'Specialty Retail' WHEN 33 THEN 'Consumer Staples Retail' ELSE 'Other Retail' END as retailer_type FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany supplier ON br.parentcompanyid = supplier.companyid JOIN ciqcompany retailer ON br.childcompanyid = retailer.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND retailer.simpleindustryid IN (31, 32, 33) AND supplier.simpleindustryid IN (34, 35, 26, 37, 38) ORDER BY retailer_type, supplier_category;",supply_chain_analysis,Retail sector supply chain risk and margin analysis,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,conditional_aggregation
TRAIN_011,"Find industrial conglomerates and their diversification","SELECT parent.companyname AS conglomerate, COUNT(DISTINCT child.simpleindustryid) as industry_diversification, STRING_AGG(DISTINCT CASE child.simpleindustryid WHEN 8 THEN 'Aerospace/Defense' WHEN 9 THEN 'Building Products' WHEN 10 THEN 'Construction/Engineering' WHEN 11 THEN 'Electrical Equipment' WHEN 13 THEN 'Machinery' WHEN 14 THEN 'Trading/Distribution' WHEN 15 THEN 'Commercial Services' WHEN 17 THEN 'Air Freight/Logistics' ELSE 'Other Industrial' END, ', ') as business_segments FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany parent ON br.parentcompanyid = parent.companyid JOIN ciqcompany child ON br.childcompanyid = child.companyid WHERE rt.parentname = 'Company' AND rt.childname = 'Strategic Alliance' AND parent.simpleindustryid = 12 AND child.simpleindustryid IN (8, 9, 10, 11, 13, 14, 15, 17) GROUP BY parent.companyid, parent.companyname HAVING COUNT(DISTINCT child.simpleindustryid) >= 3 ORDER BY industry_diversification DESC;",diversification_analysis,Industrial conglomerate value and diversification assessment,advanced,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter|having_clause,count|string_aggregation|conditional_aggregation
TRAIN_012,"Map aerospace and defense contractor relationships","SELECT contractor.companyname AS defense_contractor, supplier.companyname AS supplier, CASE supplier.simpleindustryid WHEN 6 THEN 'Metals and Mining' WHEN 11 THEN 'Electrical Equipment' WHEN 13 THEN 'Machinery' WHEN 56 THEN 'Electronic Equipment' WHEN 57 THEN 'Semiconductors' ELSE 'Other Supplier' END as supplier_type, rst.businessrelsourcetypename as data_source FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany contractor ON br.childcompanyid = contractor.companyid JOIN ciqcompany supplier ON br.parentcompanyid = supplier.companyid JOIN ciqbusinessrelsourcetype rst ON br.businessrelsourcetypeid = rst.businessrelsourcetypeid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND contractor.simpleindustryid = 8 ORDER BY contractor.companyname, supplier_type;",supply_chain_analysis,Defense sector supply chain and national security investment analysis,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany|ciqbusinessrelsourcetype,relationship_type_filter|industry_filter,conditional_aggregation
TRAIN_013,"Compare cyclical and defensive sector relationship stability","WITH sector_classification AS (SELECT companyid, companyname, CASE WHEN simpleindustryid IN (1, 2, 6, 10, 22, 23, 52, 53, 57) THEN 'Cyclical' WHEN simpleindustryid IN (33, 34, 35, 36, 37, 38, 39, 40, 43, 60, 61, 62, 63) THEN 'Defensive' ELSE 'Neutral' END as sector_type, simpleindustryid FROM ciqcompany) SELECT sc.sector_type, COUNT(DISTINCT sc.companyid) as companies, COUNT(br.businessrelid) as total_relationships, COUNT(DISTINCT br.businessreltypeid) as relationship_variety FROM sector_classification sc LEFT JOIN ciqbusinessrel br ON sc.companyid IN (br.parentcompanyid, br.childcompanyid) WHERE sc.sector_type IN ('Cyclical', 'Defensive') GROUP BY sc.sector_type ORDER BY total_relationships DESC;",risk_analysis,Economic cycle positioning and defensive investment strategy,advanced,ciqcompany|ciqbusinessrel,industry_filter|cte,count|conditional_aggregation
TRAIN_014,"Identify companies with high same-sector relationship concentration","SELECT c.companyname, CASE c.simpleindustryid WHEN 53 THEN 'Software' WHEN 43 THEN 'Pharmaceuticals' WHEN 45 THEN 'Banks' WHEN 2 THEN 'Oil and Gas' ELSE 'Other' END as company_sector, COUNT(*) as total_relationships, COUNT(CASE WHEN related.simpleindustryid = c.simpleindustryid THEN 1 END) as same_sector_relationships, ROUND(COUNT(CASE WHEN related.simpleindustryid = c.simpleindustryid THEN 1 END) * 100.0 / COUNT(*), 2) as sector_concentration_pct FROM ciqcompany c JOIN ciqbusinessrel br ON c.companyid = br.parentcompanyid JOIN ciqcompany related ON br.childcompanyid = related.companyid WHERE c.simpleindustryid IN (53, 43, 45, 2) GROUP BY c.companyid, c.companyname, c.simpleindustryid HAVING COUNT(*) >= 5 ORDER BY sector_concentration_pct DESC;",risk_analysis,Portfolio concentration risk and correlation analysis,advanced,ciqcompany|ciqbusinessrel,industry_filter|having_clause,count|conditional_aggregation|mathematical_operations
TRAIN_015,"Find the complete clean energy investment ecosystem","SELECT company.companyname, CASE company.simpleindustryid WHEN 64 THEN 'Renewable Energy Producer' WHEN 11 THEN 'Electrical Equipment (Clean Tech)' WHEN 13 THEN 'Machinery (Wind/Solar)' WHEN 6 THEN 'Metals (Battery/Solar Materials)' WHEN 3 THEN 'Chemicals (Battery/Solar)' WHEN 57 THEN 'Semiconductors (Solar)' ELSE 'Support Industry' END as clean_energy_role, COUNT(*) as ecosystem_connections FROM ciqcompany company JOIN ciqbusinessrel br ON company.companyid IN (br.parentcompanyid, br.childcompanyid) JOIN ciqcompany connected ON (br.parentcompanyid = company.companyid AND br.childcompanyid = connected.companyid) OR (br.childcompanyid = company.companyid AND br.parentcompanyid = connected.companyid) WHERE company.simpleindustryid IN (64, 11, 13, 6, 3, 57) AND connected.simpleindustryid IN (64, 11, 13, 6, 3, 57) GROUP BY company.companyid, company.companyname, company.simpleindustryid ORDER BY ecosystem_connections DESC;",esg_analysis,ESG investing and clean energy ecosystem investment opportunities,advanced,ciqcompany|ciqbusinessrel,industry_filter|complex_joins,count|conditional_aggregation
TRAIN_016,"Analyze healthcare accessibility through provider networks","SELECT provider.companyname AS healthcare_provider, COUNT(DISTINCT supplier.companyid) as supplier_diversity, COUNT(DISTINCT supplier.countryid) as geographic_supplier_reach FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany provider ON br.childcompanyid = provider.companyid JOIN ciqcompany supplier ON br.parentcompanyid = supplier.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND provider.simpleindustryid = 40 AND supplier.simpleindustryid IN (39, 41, 42, 43, 44) GROUP BY provider.companyid, provider.companyname HAVING COUNT(DISTINCT supplier.companyid) >= 3 ORDER BY supplier_diversity DESC, geographic_supplier_reach DESC;",esg_analysis,Healthcare access and social impact investment analysis,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter|having_clause,count
TRAIN_017,"Identify cross-industry acquisition patterns","SELECT CASE acquirer.simpleindustryid WHEN 53 THEN 'Software' WHEN 45 THEN 'Banks' WHEN 43 THEN 'Pharmaceuticals' WHEN 12 THEN 'Industrial Conglomerates' ELSE 'Other Acquirer' END as acquirer_industry, CASE target.simpleindustryid WHEN 53 THEN 'Software' WHEN 41 THEN 'Healthcare Technology' WHEN 42 THEN 'Biotechnology' WHEN 52 THEN 'IT Services' ELSE 'Other Target' END as target_industry, COUNT(*) as deal_count FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany acquirer ON br.parentcompanyid = acquirer.companyid JOIN ciqcompany target ON br.childcompanyid = target.companyid WHERE rt.parentname IN ('Acquirer', 'Buyer', 'Company') AND rt.childname IN ('Target', 'Acquired', 'Strategic Alliance') AND acquirer.simpleindustryid != target.simpleindustryid GROUP BY acquirer.simpleindustryid, target.simpleindustryid HAVING COUNT(*) >= 2 ORDER BY deal_count DESC;",ma_analysis,M&A strategy and cross-industry consolidation trends,advanced,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter|having_clause,count|conditional_aggregation
TRAIN_018,"Track consolidation within specific industries","SELECT CASE c.simpleindustryid WHEN 45 THEN 'Banking' WHEN 43 THEN 'Pharmaceuticals' WHEN 18 THEN 'Airlines' WHEN 49 THEN 'Insurance' WHEN 31 THEN 'Retail' ELSE 'Other Industry' END as industry, COUNT(DISTINCT br.parentcompanyid) as acquirer_count, COUNT(*) as total_deals FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany c ON br.parentcompanyid = c.companyid JOIN ciqcompany target ON br.childcompanyid = target.companyid WHERE rt.parentname IN ('Acquirer', 'Company') AND rt.childname IN ('Target', 'Strategic Alliance') AND c.simpleindustryid = target.simpleindustryid AND c.simpleindustryid IN (45, 43, 18, 49, 31) GROUP BY c.simpleindustryid ORDER BY total_deals DESC;",ma_analysis,Industry consolidation trends and market concentration analysis,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,count|conditional_aggregation
TRAIN_019,"Analyze utility companies for dividend stability","SELECT utility.companyname, CASE utility.simpleindustryid WHEN 60 THEN 'Electric Utilities' WHEN 61 THEN 'Gas Utilities' WHEN 62 THEN 'Multi-Utilities' WHEN 63 THEN 'Water Utilities' END as utility_type, COUNT(*) as supplier_relationships, COUNT(DISTINCT supplier.countryid) as supplier_geographic_diversity, (2024 - utility.yearfounded) as company_age FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany utility ON br.childcompanyid = utility.companyid JOIN ciqcompany supplier ON br.parentcompanyid = supplier.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND utility.simpleindustryid IN (60, 61, 62, 63) GROUP BY utility.companyid, utility.companyname, utility.simpleindustryid, utility.yearfounded HAVING COUNT(*) >= 2 ORDER BY company_age DESC, supplier_relationships DESC;",dividend_analysis,Dividend stability and income investing utility analysis,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter|having_clause,count|mathematical_operations
TRAIN_020,"Evaluate REIT tenant diversification for income stability","SELECT reit.companyname AS reit_name, CASE reit.simpleindustryid WHEN 69 THEN 'Hotel REITs' WHEN 71 THEN 'Office REITs' WHEN 73 THEN 'Retail REITs' WHEN 70 THEN 'Industrial REITs' ELSE 'Other REITs' END as reit_category, COUNT(*) as tenant_count, COUNT(DISTINCT tenant.simpleindustryid) as tenant_industry_diversity, ROUND(COUNT(DISTINCT tenant.simpleindustryid) * 100.0 / COUNT(*), 2) as diversification_score FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany reit ON br.parentcompanyid = reit.companyid JOIN ciqcompany tenant ON br.childcompanyid = tenant.companyid WHERE rt.parentname = 'Landlord' AND rt.childname = 'Tenant' AND reit.simpleindustryid IN (69, 70, 71, 73) GROUP BY reit.companyid, reit.companyname, reit.simpleindustryid HAVING COUNT(*) >= 3 ORDER BY diversification_score DESC, tenant_count DESC;",dividend_analysis,REIT income diversification and tenant quality analysis,advanced,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter|having_clause,count|mathematical_operations
TRAIN_021,"Find companies with expanding partnerships in growth sectors","SELECT c.companyname, CASE c.simpleindustryid WHEN 42 THEN 'Biotechnology' WHEN 53 THEN 'Software' WHEN 67 THEN 'Interactive Media' WHEN 41 THEN 'Health Care Technology' WHEN 64 THEN 'Renewable Energy' ELSE 'Other Growth Sector' END as growth_sector, COUNT(*) as partnership_count, COUNT(DISTINCT related.simpleindustryid) as cross_industry_reach, (2024 - c.yearfounded) as company_age FROM ciqcompany c JOIN ciqbusinessrel br ON c.companyid IN (br.parentcompanyid, br.childcompanyid) JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany related ON (c.companyid = br.parentcompanyid AND related.companyid = br.childcompanyid) OR (c.companyid = br.childcompanyid AND related.companyid = br.parentcompanyid) WHERE c.simpleindustryid IN (42, 53, 67, 41, 64) AND rt.parentname IN ('Company', 'Franchisor', 'Licensor', 'Supplier') AND c.yearfounded >= 2010 GROUP BY c.companyid, c.companyname, c.simpleindustryid, c.yearfounded HAVING COUNT(*) >= 3 ORDER BY partnership_count DESC, cross_industry_reach DESC;",growth_analysis,Growth investing and emerging company partnership expansion,advanced,ciqcompany|ciqbusinessrel|ciqbusinessreltype,relationship_type_filter|industry_filter|date_filter|having_clause,count|mathematical_operations|complex_joins
TRAIN_022,"Map innovation partnerships between technology and traditional industries","SELECT tech.companyname AS tech_company, traditional.companyname AS traditional_company, CASE tech.simpleindustryid WHEN 53 THEN 'Software' WHEN 41 THEN 'Health Tech' WHEN 52 THEN 'IT Services' WHEN 67 THEN 'Interactive Media' END as tech_category, CASE traditional.simpleindustryid WHEN 45 THEN 'Banking' WHEN 40 THEN 'Healthcare' WHEN 23 THEN 'Automotive' WHEN 31 THEN 'Retail' WHEN 27 THEN 'Hospitality' END as traditional_industry, rt.parentname as partnership_type FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany tech ON br.parentcompanyid = tech.companyid JOIN ciqcompany traditional ON br.childcompanyid = traditional.companyid WHERE tech.simpleindustryid IN (53, 41, 52, 67) AND traditional.simpleindustryid IN (45, 40, 23, 31, 27) AND rt.parentname IN ('Supplier', 'Licensor', 'Company') ORDER BY tech_category, traditional_industry;",innovation_analysis,Digital transformation and technology adoption investment opportunities,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter,conditional_aggregation
TRAIN_023,"Compare early cycle vs late cycle sector relationships","WITH cycle_sectors AS (SELECT companyid, companyname, CASE WHEN simpleindustryid IN (6, 10, 13, 22, 23) THEN 'Early Cycle' WHEN simpleindustryid IN (33, 34, 35, 60, 61) THEN 'Late Cycle' WHEN simpleindustryid IN (45, 46, 49) THEN 'Interest Sensitive' ELSE 'Other' END as cycle_position, simpleindustryid FROM ciqcompany) SELECT cs.cycle_position, COUNT(DISTINCT cs.companyid) as company_count, COUNT(br.businessrelid) as total_relationships, ROUND(COUNT(br.businessrelid) * 1.0 / COUNT(DISTINCT cs.companyid), 2) as avg_relationships_per_company FROM cycle_sectors cs LEFT JOIN ciqbusinessrel br ON cs.companyid IN (br.parentcompanyid, br.childcompanyid) WHERE cs.cycle_position IN ('Early Cycle', 'Late Cycle', 'Interest Sensitive') GROUP BY cs.cycle_position ORDER BY avg_relationships_per_company DESC;",sector_rotation,Economic cycle investment strategy and sector rotation timing,advanced,ciqcompany|ciqbusinessrel,industry_filter|cte,count|mathematical_operations
TRAIN_024,"Identify companies in inflation-resistant sectors","SELECT c.companyname, CASE c.simpleindustryid WHEN 2 THEN 'Oil and Gas' WHEN 6 THEN 'Metals and Mining' WHEN 50 THEN 'Diversified REITs' WHEN 51 THEN 'Real Estate Development' WHEN 3 THEN 'Chemicals' WHEN 35 THEN 'Food Products' END as inflation_hedge_sector, COUNT(*) as supplier_relationships, COUNT(CASE WHEN supplier.simpleindustryid IN (2, 6, 3) THEN 1 END) as commodity_supplier_count, ROUND(COUNT(CASE WHEN supplier.simpleindustryid IN (2, 6, 3) THEN 1 END) * 100.0 / COUNT(*), 2) as commodity_exposure_pct FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany c ON br.childcompanyid = c.companyid JOIN ciqcompany supplier ON br.parentcompanyid = supplier.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND c.simpleindustryid IN (2, 6, 50, 51, 3, 35) GROUP BY c.companyid, c.companyname, c.simpleindustryid HAVING COUNT(*) >= 2 ORDER BY commodity_exposure_pct DESC;",inflation_hedge,Inflation hedging strategy and commodity exposure analysis,advanced,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter|having_clause,count|conditional_aggregation|mathematical_operations
TRAIN_025,"Find potential private equity targets with fragmented supplier bases","SELECT target.companyname AS potential_target, CASE target.simpleindustryid WHEN 15 THEN 'Commercial Services' WHEN 16 THEN 'Professional Services' WHEN 28 THEN 'Diversified Consumer Services' WHEN 27 THEN 'Hotels and Restaurants' WHEN 32 THEN 'Specialty Retail' END as target_sector, COUNT(*) as supplier_count, COUNT(DISTINCT supplier.simpleindustryid) as supplier_industry_diversity, (2024 - target.yearfounded) as company_maturity FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany target ON br.childcompanyid = target.companyid JOIN ciqcompany supplier ON br.parentcompanyid = supplier.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' AND target.simpleindustryid IN (15, 16, 28, 27, 32) AND target.yearfounded <= 2010 GROUP BY target.companyid, target.companyname, target.simpleindustryid, target.yearfounded HAVING COUNT(*) >= 3 ORDER BY supplier_count DESC, supplier_industry_diversity DESC;",private_equity,Private equity acquisition target identification and value creation opportunities,advanced,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter|date_filter|having_clause,count|mathematical_operations
TRAIN_026,"Map venture capital funding ecosystems","SELECT startup.companyname AS startup_company, CASE startup.simpleindustryid WHEN 42 THEN 'Biotechnology' WHEN 53 THEN 'Software' WHEN 67 THEN 'Interactive Media' WHEN 41 THEN 'Health Tech' WHEN 64 THEN 'Clean Energy' END as startup_sector, COUNT(DISTINCT partner.companyid) as strategic_partners, COUNT(DISTINCT partner.simpleindustryid) as partner_industry_diversity, startup.yearfounded FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany startup ON br.parentcompanyid = startup.companyid JOIN ciqcompany partner ON br.childcompanyid = partner.companyid WHERE rt.parentname = 'Company' AND rt.childname = 'Strategic Alliance' AND startup.simpleindustryid IN (42, 53, 67, 41, 64) AND startup.yearfounded >= 2010 GROUP BY startup.companyid, startup.companyname, startup.simpleindustryid, startup.yearfounded HAVING COUNT(DISTINCT partner.companyid) >= 2 ORDER BY startup.yearfounded DESC, strategic_partners DESC;",venture_capital,Venture capital ecosystem analysis and startup partnership validation,advanced,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|industry_filter|date_filter|having_clause,count
TRAIN_027,"Calculate business network strength scores for companies","WITH network_metrics AS (SELECT c.companyid, c.companyname, c.simpleindustryid, COUNT(*) as total_relationships, COUNT(DISTINCT br.businessreltypeid) as relationship_diversity, COUNT(DISTINCT related.simpleindustryid) as industry_reach, COUNT(DISTINCT related.countryid) as geographic_reach FROM ciqcompany c JOIN ciqbusinessrel br ON c.companyid IN (br.parentcompanyid, br.childcompanyid) JOIN ciqcompany related ON (c.companyid = br.parentcompanyid AND related.companyid = br.childcompanyid) OR (c.companyid = br.childcompanyid AND related.companyid = br.parentcompanyid) GROUP BY c.companyid, c.companyname, c.simpleindustryid HAVING COUNT(*) >= 3) SELECT companyname, CASE simpleindustryid WHEN 53 THEN 'Software' WHEN 43 THEN 'Pharmaceuticals' WHEN 45 THEN 'Banks' WHEN 12 THEN 'Industrial Conglomerates' ELSE 'Other' END as sector, total_relationships, relationship_diversity, industry_reach, geographic_reach, ROUND((relationship_diversity * 20) + (LEAST(industry_reach, 5) * 10) + (LEAST(geographic_reach, 3) * 10), 2) as network_strength_score FROM network_metrics ORDER BY network_strength_score DESC;",quantitative_analysis,Quantitative investment scoring and network analysis for stock selection,advanced,ciqcompany|ciqbusinessrel,having_clause|complex_joins|cte,count|mathematical_operations|conditional_aggregation
TRAIN_028,"Create risk-reward matrix based on business relationships","WITH risk_reward_metrics AS (SELECT c.companyid, c.companyname, c.simpleindustryid, (2024 - c.yearfounded) as company_age, COUNT(*) as total_relationships, COUNT(CASE WHEN related.simpleindustryid = c.simpleindustryid THEN 1 END) * 100.0 / COUNT(*) as sector_concentration_risk, COUNT(DISTINCT br.businessreltypeid) as relationship_diversity_score FROM ciqcompany c JOIN ciqbusinessrel br ON c.companyid IN (br.parentcompanyid, br.childcompanyid) JOIN ciqcompany related ON (c.companyid = br.parentcompanyid AND related.companyid = br.childcompanyid) OR (c.companyid = br.childcompanyid AND related.companyid = br.parentcompanyid) GROUP BY c.companyid, c.companyname, c.simpleindustryid, c.yearfounded HAVING COUNT(*) >= 3) SELECT companyname, CASE simpleindustryid WHEN 53 THEN 'Software' WHEN 43 THEN 'Pharmaceuticals' WHEN 45 THEN 'Banks' WHEN 42 THEN 'Biotechnology' ELSE 'Other' END as sector, ROUND(sector_concentration_risk, 2) as overall_risk_score, ROUND(relationship_diversity_score * 10, 2) as overall_reward_score FROM risk_reward_metrics ORDER BY overall_reward_score DESC;",risk_analysis,Investment risk-reward analysis and portfolio optimization scoring,advanced,ciqcompany|ciqbusinessrel,having_clause|complex_joins|cte,count|mathematical_operations|conditional_aggregation
TRAIN_029,"Create competitive intelligence dashboard for key sectors","SELECT CASE c.simpleindustryid WHEN 53 THEN 'Software' WHEN 43 THEN 'Pharmaceuticals' WHEN 52 THEN 'IT Services' WHEN 42 THEN 'Biotechnology' WHEN 45 THEN 'Banking' END as industry_sector, COUNT(DISTINCT c.companyid) as total_companies, COUNT(br.businessrelid) as total_relationships, COUNT(CASE WHEN rt.parentname = 'Supplier' THEN 1 END) as supplier_relationships, COUNT(CASE WHEN rt.parentname = 'Company' THEN 1 END) as strategic_alliances FROM ciqcompany c LEFT JOIN ciqbusinessrel br ON c.companyid IN (br.parentcompanyid, br.childcompanyid) LEFT JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid WHERE c.simpleindustryid IN (53, 43, 52, 42, 45) GROUP BY c.simpleindustryid ORDER BY total_relationships DESC;",competitive_intelligence,Market intelligence and competitive landscape analysis for investment decisions,intermediate,ciqcompany|ciqbusinessrel|ciqbusinessreltype,industry_filter,count|conditional_aggregation
TRAIN_030,"Estimate market influence through business relationship networks","WITH market_influence AS (SELECT c.companyid, c.companyname, c.simpleindustryid, COUNT(CASE WHEN rt.childname IN ('Customer', 'Client Services', 'Client TA', 'Client IR') THEN 1 END) as customer_count, COUNT(CASE WHEN rt.parentname = 'Supplier' THEN 1 END) as supplier_count, COUNT(CASE WHEN rt.parentname = 'Company' AND rt.childname = 'Strategic Alliance' THEN 1 END) as partnership_count, COUNT(*) as total_relationships FROM ciqcompany c JOIN ciqbusinessrel br ON c.companyid IN (br.parentcompanyid, br.childcompanyid) JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid GROUP BY c.companyid, c.companyname, c.simpleindustryid) SELECT companyname, CASE simpleindustryid WHEN 53 THEN 'Software' WHEN 31 THEN 'Broadline Retail' WHEN 45 THEN 'Banks' WHEN 2 THEN 'Oil and Gas' WHEN 43 THEN 'Pharmaceuticals' ELSE 'Other' END as sector, customer_count, supplier_count, partnership_count, ROUND((customer_count * 3) + (supplier_count * 2) + (partnership_count * 4), 2) as market_influence_score FROM market_influence WHERE total_relationships >= 3 AND simpleindustryid IN (53, 31, 45, 2, 43) ORDER BY market_influence_score DESC;",market_analysis,Market share estimation and competitive positioning analysis through relationship networks,advanced,ciqcompany|ciqbusinessrel|ciqbusinessreltype,industry_filter|cte,count|conditional_aggregation|mathematical_operations
TRAIN_031,"Show all companies founded after 2010","SELECT companyid, companyname, yearfounded, monthfounded, simpleindustryid FROM ciqcompany WHERE yearfounded > 2010 ORDER BY yearfounded DESC, monthfounded DESC;",company_discovery,Growth investing and emerging company identification,beginner,ciqcompany,date_filter,none
TRAIN_032,"List companies by incorporation country","SELECT incorporationcountryid, COUNT(*) as company_count FROM ciqcompany GROUP BY incorporationcountryid ORDER BY company_count DESC;",geographic_analysis,Geographic diversification and international investment opportunities,beginner,ciqcompany,none,count
TRAIN_033,"Which companies have the most business partnerships?","SELECT c.companyname, COUNT(CASE WHEN br.parentcompanyid = c.companyid THEN 1 END) as parent_relationships, COUNT(CASE WHEN br.childcompanyid = c.companyid THEN 1 END) as child_relationships, COUNT(*) as total_relationships FROM ciqcompany c LEFT JOIN ciqbusinessrel br ON c.companyid IN (br.parentcompanyid, br.childcompanyid) GROUP BY c.companyid, c.companyname HAVING COUNT(*) > 0 ORDER BY total_relationships DESC;",relationship_analysis,Business network analysis and partnership strength assessment,intermediate,ciqcompany|ciqbusinessrel,having_clause,count|conditional_aggregation
TRAIN_034,"Show me all supplier-customer relationships","SELECT supplier.companyname AS supplier_company, customer.companyname AS customer_company, supplier.simpleindustryid AS supplier_industry, customer.simpleindustryid AS customer_industry, rst.businessrelsourcetypename AS data_reliability FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany supplier ON br.parentcompanyid = supplier.companyid JOIN ciqcompany customer ON br.childcompanyid = customer.companyid JOIN ciqbusinessrelsourcetype rst ON br.businessrelsourcetypeid = rst.businessrelsourcetypeid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer';",supply_chain_analysis,Supply chain mapping and vendor relationship analysis for investment research,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany|ciqbusinessrelsourcetype,relationship_type_filter,none
TRAIN_035,"Find companies with diverse supplier base","SELECT customer.companyname, customer.simpleindustryid, COUNT(DISTINCT supplier.simpleindustryid) as supplier_industry_diversity, COUNT(*) as total_suppliers FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany supplier ON br.parentcompanyid = supplier.companyid JOIN ciqcompany customer ON br.childcompanyid = customer.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' GROUP BY customer.companyid, customer.companyname, customer.simpleindustryid HAVING COUNT(*) >= 3 ORDER BY supplier_industry_diversity DESC, total_suppliers DESC;",risk_analysis,Supply chain diversification analysis for operational risk assessment,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|having_clause,count
TRAIN_036,"Identify companies heavily dependent on single suppliers","SELECT customer.companyname AS at_risk_company, COUNT(*) as supplier_count, CASE WHEN COUNT(*) = 1 THEN 'High Risk - Single Supplier' WHEN COUNT(*) <= 3 THEN 'Medium Risk - Few Suppliers' ELSE 'Low Risk - Diversified' END as risk_level FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany customer ON br.childcompanyid = customer.companyid WHERE rt.parentname = 'Supplier' AND rt.childname = 'Customer' GROUP BY customer.companyid, customer.companyname ORDER BY supplier_count ASC;",risk_analysis,Supply chain concentration risk identification for investment due diligence,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter,count|conditional_aggregation
TRAIN_037,"Find all strategic alliances and partnerships","SELECT parent.companyname AS company1, child.companyname AS company2, rt.parentname, rt.childname, parent.simpleindustryid AS industry1, child.simpleindustryid AS industry2, CASE WHEN parent.simpleindustryid = child.simpleindustryid THEN 'Same Industry' ELSE 'Cross Industry' END as partnership_type FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany parent ON br.parentcompanyid = parent.companyid JOIN ciqcompany child ON br.childcompanyid = child.companyid WHERE rt.parentname = 'Company' AND rt.childname = 'Strategic Alliance';",partnership_analysis,Strategic alliance identification and cross-industry collaboration analysis,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter,conditional_aggregation
TRAIN_038,"Which companies are most active in forming strategic partnerships?","SELECT c.companyname, c.simpleindustryid, COUNT(*) as strategic_partnerships, MIN(c.yearfounded) as company_age_indicator FROM ciqcompany c JOIN ciqbusinessrel br ON c.companyid IN (br.parentcompanyid, br.childcompanyid) JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid WHERE rt.parentname = 'Company' AND rt.childname = 'Strategic Alliance' GROUP BY c.companyid, c.companyname, c.simpleindustryid ORDER BY strategic_partnerships DESC;",partnership_analysis,Strategic partnership activity analysis for growth and collaboration assessment,intermediate,ciqcompany|ciqbusinessrel|ciqbusinessreltype,relationship_type_filter,count|min
TRAIN_039,"Show all franchise opportunities","SELECT franchisor.companyname AS franchise_brand, COUNT(*) as franchisee_count, COUNT(DISTINCT franchisee.countryid) as geographic_reach, franchisor.yearfounded as brand_established, (2024 - franchisor.yearfounded) as years_in_business FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany franchisor ON br.parentcompanyid = franchisor.companyid JOIN ciqcompany franchisee ON br.childcompanyid = franchisee.companyid WHERE rt.parentname = 'Franchisor' AND rt.childname = 'Franchisee' GROUP BY franchisor.companyid, franchisor.companyname, franchisor.yearfounded ORDER BY franchisee_count DESC;",franchise_analysis,Franchise investment opportunity analysis and brand expansion assessment,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter,count|mathematical_operations
TRAIN_040,"Find companies with strong intellectual property licensing","SELECT licensor.companyname AS ip_owner, COUNT(*) as licensee_count, COUNT(DISTINCT licensee.simpleindustryid) as industry_diversity, licensor.simpleindustryid AS core_industry FROM ciqbusinessrel br JOIN ciqbusinessreltype rt ON br.businessreltypeid = rt.businessreltypeid JOIN ciqcompany licensor ON br.parentcompanyid = licensor.companyid JOIN ciqcompany licensee ON br.childcompanyid = licensee.companyid WHERE rt.parentname = 'Licensor' AND rt.childname = 'Licensee' GROUP BY licensor.companyid, licensor.companyname, licensor.simpleindustryid HAVING COUNT(*) >= 2 ORDER BY licensee_count DESC, industry_diversity DESC;",ip_analysis,Intellectual property monetization and licensing revenue stream analysis,intermediate,ciqbusinessrel|ciqbusinessreltype|ciqcompany,relationship_type_filter|having_clause,count